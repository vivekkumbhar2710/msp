[
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Production",
  "enabled": 1,
  "modified": "2023-12-18 13:29:47.529789",
  "module": "Ms Production",
  "name": "Filter-Proudction",
  "script": "var item_group=\"CASTING\"\nvar company_field ='custom_company'\n\n\nfrappe.ui.form.on('Production', {\n\tsetup: function(frm) {\n\t\tfrm.set_query(\"item\", \"items\", function(doc, cdt, cdn) {\n\t\t\tlet d = locals[cdt][cdn];\n\t\t\treturn {\n\n\t\t\t\tfilters: [\n\t\t\t\t  ['Item', 'item_group', '=',item_group],\n\t\t\t\t  [\"Item\", company_field, '=', frm.doc.company]\n\t\t\t\t]\n\t\t\t};\n\t\t});\n\t\tfrm.set_query(\"source_warehouse\", \"tooling_details\", function(doc, cdt, cdn) {\n\t\t\tlet d = locals[cdt][cdn];\n\t\t\treturn {\n\n\t\t\t\tfilters: [\n\t\t\t\t  ['Warehouse', 'company', '=',frm.doc.company],\n\t\t\t\t]\n\t\t\t};\n\t\t});\n\t\tfrm.set_query(\"rejection_type\", \"rejected_items_reasons\", function(doc, cdt, cdn) {\n\t\t\tlet d = locals[cdt][cdn];\n\t\t\treturn {\n\n\t\t\t\tfilters: [\n\t\t\t\t  ['Rejection Type', 'company', '=',frm.doc.company],\n\t\t\t\t]\n\t\t\t};\n\t\t});\n\t\t\tfrm.set_query(\"target_warehouse\", \"rejected_items_reasons\", function(doc, cdt, cdn) {\n\t\t\tlet d = locals[cdt][cdn];\n\t\t\treturn {\n\n\t\t\t\tfilters: [\n\t\t\t\t  ['Warehouse', 'company', '=',frm.doc.company],\n\t\t\t\t]\n\t\t\t};\n\t\t});\n\t\t\n\t\t\t\n\t\tfrm.set_query(\"item\", \"raw_items\", function(doc, cdt, cdn) {\n\t\t\tlet d = locals[cdt][cdn];\n\t\t\treturn {\n\n\t\t\t\tfilters: [\n\t\t\t\t  ['Item', 'item_group', '=',item_group],\n\t\t\t\t  [\"Item\", company_field, '=', frm.doc.company]\n\t\t\t\t]\n\t\t\t};\n\t\t});\n\t\t\n\t\tfrm.set_query(\"item\", \"item_operations\", function(doc, cdt, cdn) {\n\t\t\tlet d = locals[cdt][cdn];\n\t\t\treturn {\n\t\t\t\tfilters: [\n\t\t\t\t  ['Item', 'item_group', '=',item_group],\n\t\t\t\t  [\"Item\", company_field, '=', frm.doc.company]\n\t\t\t\t]\n\t\t\t};\n\t\t});\n\t\t\n\t\tfrm.set_query(\"machine\", \"item_operations\", function(doc, cdt, cdn) {\n\t\t\tlet d = locals[cdt][cdn];\n\t\t\treturn {\n\t\t\t\tfilters: [\n\t\t\t\t  ['Machine', 'company', '=',frm.doc.company],\n\t\t\t\t]\n\t\t\t};\n\t\t});\n\t\t\n\t\tfrm.set_query(\"operation\", \"item_operations\", function(doc, cdt, cdn) {\n\t\t\tlet d = locals[cdt][cdn];\n\t\t\treturn {\n\t\t\t\tfilters: [\n\t\t\t\t  ['Operation Master', 'company', '=',frm.doc.company],\n\t\t\t\t]\n\t\t\t};\n\t\t});\n\t\t\n\t\t\tfrm.set_query(\"job_order\", \"qty_details\", function(doc, cdt, cdn) {\n\t\t\tlet d = locals[cdt][cdn];\n\t\t\treturn {\n\t\t\t\tfilters: [\n\t\t\t\t  ['Job Order', 'company', '=',frm.doc.company],\n\t\t\t\t]\n\t\t\t};\n\t\t});\n\t\t\n\t\tfrm.set_query(\"raw_item\", \"raw_items\", function(doc, cdt, cdn) {\n\t\t\tlet d = locals[cdt][cdn];\n\t\t\treturn {\n\n\t\t\t\tfilters: [\n\t\t\t\t  ['Item', 'item_group', '=', \"Raw Material\"],\n\t\t\t\t  [\"Item\", company_field, '=', frm.doc.company],\n\t\t\t\t]\n\t\t\t};\n\t\t});\n\t\t\n\t\tfrm.set_query(\"item\", \"qty_details\", function(doc, cdt, cdn) {\n\t\tlet d = locals[cdt][cdn];\n\t\treturn {\n\t\t\tfilters: [\n\t\t\t  ['Item', 'item_group', '=',item_group],\n\t\t\t  [\"Item\", company_field, '=', frm.doc.company]\n\t\t\t]\n\t\t    };\n\t\t});\n\t\t\n\t\tfrm.set_query(\"finished_item\", \"rejected_items_reasons\", function(doc, cdt, cdn) {\n\t\tlet d = locals[cdt][cdn];\n\t\treturn {\n\t\t\tfilters: [\n\t\t\t  ['Item', 'item_group', '=',item_group],\n\t\t\t  [\"Item\", company_field, '=', frm.doc.company]\n\t\t\t]\n\t\t    };\n\t\t});\n\t\t\n\t\t\n\t\tfrm.set_query(\"job_order\", \"rejected_items_reasons\", function(doc, cdt, cdn) {\n\t\tlet d = locals[cdt][cdn];\n\t\treturn {\n\t\t\tfilters: [\n\t\t\t  [\"Job Order\", \"company\", '=', frm.doc.company]\n\t\t\t]\n\t\t    };\n\t\t});\n\t\t\n\t\tfrm.set_query(\"operation\", \"rejected_items_reasons\", function(doc, cdt, cdn) {\n\t\tlet d = locals[cdt][cdn];\n\t\treturn {\n\t\t\tfilters: [\n\t\t\t  [\"Operation Master\", \"company\", '=', frm.doc.company]\n\t\t\t]\n\t\t    };\n\t\t});\n\t\t\n\t\t\n\t\t\n\t\tfrm.set_query(\"supervisor\", function(doc) {\n\t\t\treturn {\n\t\t\t\tfilters: [\n\t\t\t\t\t['Employee', 'designation', '=', 'Supervisor'],\n\t\t\t\t\t[\"Employee\", \"company\", '=', frm.doc.company]\n\t\t\t\t]\n\t\t\t};\n\t\t});\n\t\t\n\t\tfrm.set_query(\"operator\", function(doc) {\n\t\t\treturn {\n\t\t\t\tfilters: [\n\t\t\t\t\t['Employee', 'designation', '=', 'Operator'],\n\t\t\t\t\t[\"Employee\", \"company\", '=', frm.doc.company]\n\t\t\t\t]\n\t\t\t};\n\t\t});\n\t\t\n\t\tfrm.set_query(\"rejection_reason\", \"rejected_items_reasons\", function(doc, cdt, cdn) {\n            let d = locals[cdt][cdn];\n            return {\n                filters: {\n                    'rejection_type': d.rejection_type,\n                }\n            };\n        });\n        \n        frm.set_query(\"item\", \"consumable_details\", function(doc, cdt, cdn) {\n\t\t\tlet d = locals[cdt][cdn];\n\t\t\treturn {\n\n\t\t\t\tfilters: [\n\t\t\t\t  ['Item', 'item_group', '=', \"Consumable\"],\n\t\t\t\t  [\"Item\", company_field, '=', frm.doc.company]\n\t\t\t\t]\n\t\t\t};\n\t\t});\n\t\t\n\t\t frm.set_query(\"source_warehouse\", \"consumable_details\", function(doc, cdt, cdn) {\n\t\t\tlet d = locals[cdt][cdn];\n\t\t\treturn {\n\n\t\t\t\tfilters: [\n\t\t\t\t   [\"Warehouse\", \"company\", '=', frm.doc.company],\n\t\t\t\t]\n\t\t\t};\n\t\t});\n\t\t\n\t\tfrm.set_query(\"finished_item\", \"tooling_details\", function(doc, cdt, cdn) {\n            let d = locals[cdt][cdn];\n            var items = frm.doc.items;  // Access items from frm.doc\n            return {\n                filters: [\n                    // ['Item', 'item_group', '=', \"Consumable\"],\n                    ['Item', 'name', 'in', items.map(item => item.item)],  // Filter based on items list\n                    [\"Item\", company_field, '=', frm.doc.company]\n                ]\n            };\n        });\n        frm.set_query(\"tooling_item\", \"tooling_details\", function(doc, cdt, cdn) {\n\t\t\tlet d = locals[cdt][cdn];\n\t\t\treturn {\n\n\t\t\t\tfilters: [\n\t\t\t\t        ['Item', 'item_group', '=', \"Tooling\"],\n\t\t\t\t        [\"Item\", company_field, '=', frm.doc.company]\n\t\t\t\t]\n\t\t\t};\n        });\n        frm.set_query(\"finished_item\", \"consumable_details\", function(doc, cdt, cdn) {\n            let d = locals[cdt][cdn];\n            var items = frm.doc.items;  // Access items from frm.doc\n\n            return {\n                filters: [\n                    // ['Item', 'item_group', '=', \"Consumable\"],\n                    ['Item', 'name', 'in', items.map(item => item.item)]  // Filter based on items list\n                ]\n            };\n        });\n        \n        \tfrm.set_query(\"shift_time\", function(doc) {\n\t\t\treturn {\n\t\t\t\tfilters: [\n\t\t\t\t\t['Shift Time', 'compnay', '=', frm.doc.company],\n\t\t\t\t]\n\t\t\t};\n\t\t});\n\t\t\n\t\t\tfrm.set_query(\"expense_account_for_wages\", function(doc) {\n\t\t\treturn {\n\t\t\t\tfilters: [\n\t\t\t\t\t['Account', 'company', '=', frm.doc.company],\n\t\t\t\t]\n\t\t\t};\n\t\t});\n\t}\n});\n",
  "view": "Form"
 },
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Downstream Processes",
  "enabled": 1,
  "modified": "2023-12-18 12:33:23.321120",
  "module": "Ms Production",
  "name": "Filter-Downstream Processes",
  "script": "var item_group=\"CASTING\";\nvar company_field ='custom_company'\n\n\n\n\n\nfrappe.ui.form.on('Downstream Processes', {\n\tsetup: function(frm) {\n         frm.set_query(\"supervisor\", function(doc) {\n\t\t\treturn {\n\t\t\t\tfilters: [\n\t\t\t\t\t['Employee', 'designation', '=', 'Supervisor'],\n\t\t\t\t\t[\"Employee\", \"company\", '=', frm.doc.company]\n\t\t\t\t]\n\t\t\t};\n\t\t});\n    \t\n    frm.set_query(\"operator\", function(doc) {\n\t\t\treturn {\n\t\t\t\tfilters: [\n\t\t\t\t\t['Employee', 'designation', '=', 'Operator'],\n\t\t\t\t\t[\"Employee\", \"company\", '=', frm.doc.company]\n\t\t\t\t]\n\t\t\t};\n\t\t});\n\t\t\n    frm.set_query(\"production\", function(doc) {\n\t\t\treturn {\n\t\t\t\tfilters: [\n\t\t\t    \t['Production', 'docstatus', '=', '1'],\n\t\t\t    \t[\"Production\", \"company\", '=', frm.doc.company],\n\t\t\t    \t[\"Production\",\"ready_to_downstream\",\"=\",true]\n\t\t\t\t]   \n\t\t\t};\n\t\t});\n\t\n\tfrm.set_query(\"production\",\"items\", function(doc) {\n\t\t\treturn {\n\t\t\t\tfilters: [\n\t\t\t    \t['Production', 'docstatus', '=', '1'],\n\t\t\t    \t[\"Production\", \"company\", '=', frm.doc.company]\n\t\t\t\t]   \n\t\t\t};\n\t\t});\n\t\t\n\tfrm.set_query(\"item\",\"items\", function(doc) {\n\t\t\treturn {\n\t\t\t\tfilters: [\n\t\t\t        ['Item', 'item_group', '=',item_group],\n        \t\t\t[\"Item\", company_field, '=', frm.doc.company]\n\t\t\t\t]   \n\t\t\t};\n\t\t});\n\t\n\tfrm.set_query(\"production\",\"raw_items\", function(doc) {\n\t\t\treturn {\n\t\t\t\tfilters: [\n\t\t\t    \t['Production', 'docstatus', '=', '1'],\n\t\t\t    \t[\"Production\", \"company\", '=', frm.doc.company]\n\t\t\t\t]   \n\t\t\t};\n\t\t});\n\t\n\t\tfrm.set_query(\"source_warehouse\",\"raw_items\", function(doc) {\n\t\t\treturn {\n\t\t\t\tfilters: [\n\t\t\t    \t[\"Warehouse\", \"company\", '=', frm.doc.company]\n\t\t\t\t]   \n\t\t\t};\n\t\t});\n\t\n\tfrm.set_query(\"item\",\"raw_items\", function(doc) {\n\t\treturn {\n\t\t\tfilters: [\n\t\t        ['Item', 'item_group', '=',item_group],\n    \t\t\t[\"Item\", company_field, '=', frm.doc.company]\n\t\t\t]   \n\t\t};\n\t});\n\t\n\tfrm.set_query(\"raw_item\",\"raw_items\", function(doc) {\n\treturn {\n\t\tfilters: [\n\t\t\t[\"Item\", company_field, '=', frm.doc.company]\n\t\t]   \n\t};\n\t});\n\t\n\t\t\n\tfrm.set_query(\"item\",\"qty_details\", function(doc) {\n\t\treturn {\n\t\t\tfilters: [\n\t\t        ['Item', 'item_group', '=',item_group],\n    \t\t\t[\"Item\", company_field, '=', frm.doc.company]\n\t\t\t]   \n\t\t};\n\t});\n\n\tfrm.set_query(\"production\",\"qty_details\", function(doc) {\n\t\treturn {\n\t\t\tfilters: [\n\t\t    \t['Production', 'docstatus', '=', '1'],\n\t\t    \t[\"Production\", \"company\", '=', frm.doc.company]\n\t\t\t]   \n\t\t};\n\t});\n\t\n\t\tfrm.set_query(\"job_order\",\"qty_details\", function(doc) {\n\t\treturn {\n\t\t\tfilters: [\n\t\t    \t[\"Job Order\", \"company\", '=', frm.doc.company]\n\t\t\t]   \n\t\t};\n\t});\n\tfrm.set_query(\"finished_item\",\"rejected_items_reasons\", function(doc) {\n\t\treturn {\n\t\t\tfilters: [\n\t\t       ['Item', 'item_group', '=',item_group],\n    \t\t\t[\"Item\", company_field, '=', frm.doc.company]\n\t\t\t]   \n\t\t};\n\t});\n\tfrm.set_query(\"job_order\",\"rejected_items_reasons\", function(doc) {\n\t\treturn {\n\t\t\tfilters: [\n\t\t       \t[\"Job Order\", \"company\", '=', frm.doc.company]\n\t\t\t]   \n\t\t};\n\t});\n\t\n\tfrm.set_query(\"rejection_reason\",\"rejected_items_reasons\", function(doc) {\n\t\treturn {\n\t\t\tfilters: [\n\t\t       \t[\"Rejection Reason\", \"company\", '=', frm.doc.company],\n\t\t       \t['rejection_type', '=', d.rejection_type]\n\t\t\t]   \n\t\t};\n\t});\n\t\tfrm.set_query(\"rejection_type\",\"rejected_items_reasons\", function(doc) {\n\t\treturn {\n\t\t\tfilters: [\n\t\t       \t[\"Rejection Type\", \"company\", '=', frm.doc.company]\n\t\t\t]   \n\t\t};\n\t});\n\t\n\tfrm.set_query(\"downstream_process\", function(doc) {\n\t\t\treturn {\n\t\t\t\tfilters: [\n\t\t\t    \t[\"Downstream Processes Master\", \"company\", '=', frm.doc.company],\n\t\t\t\t]   \n\t\t\t};\n\t\t});\n\t}\n});\n\n\n ",
  "view": "Form"
 },
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Material Cycle Time",
  "enabled": 1,
  "modified": "2023-12-18 12:29:37.331363",
  "module": "Ms Production",
  "name": "Filter-Material Cycle Time",
  "script": "var item_group=\"CASTING\"\nvar company_field ='custom_company'\n\nfrappe.ui.form.on('Material Cycle Time', {\n\tsetup: function(frm) {\n    \tfrm.set_query(\"item\",function(doc, cdt, cdn) {\n\t\tlet d = locals[cdt][cdn];\n\t\treturn {\n\t\t\tfilters: [\n        \t\t\t  ['Item', 'item_group', '=',item_group],\n        \t\t\t  [\"Item\", company_field, '=', frm.doc.company]\n\t\t\t\t]\n\t\t\t};\n    \t});\n        \n        \tfrm.set_query(\"raw_item\",function(doc, cdt, cdn) {\n\t\tlet d = locals[cdt][cdn];\n\t\treturn {\n\t\t\tfilters: [\n        \t\t\t  [\"Item\", company_field, '=', frm.doc.company]\n\t\t\t\t]\n\t\t\t};\n    \t});\n    \t\n    \t\tfrm.set_query(\"operation\",\"machine_operation_plan\",function(doc, cdt, cdn) {\n\t\tlet d = locals[cdt][cdn];\n\t\treturn {\n\t\t\tfilters: [\n        \t\t\t  [\"Operation Master\", \"company\", '=', frm.doc.company]\n\t\t\t\t]\n\t\t\t};\n    \t});\n    \t\n    \tfrm.set_query(\"downstream_process\",\"row_items\",function(doc, cdt, cdn) {\n\t\tlet d = locals[cdt][cdn];\n\t\treturn {\n\t\t\tfilters: [\n        \t\t\t  [\"Downstream Processes Master\", \"company\", '=', frm.doc.company]\n\t\t\t\t]\n\t\t\t};\n    \t});\n    \t\n    \tfrm.set_query(\"item\",\"row_items\",function(doc, cdt, cdn) {\n\t\tlet d = locals[cdt][cdn];\n\t\treturn {\n\t\t\tfilters: [\n        \t\t\t  [\"Item\", company_field, '=', frm.doc.company]\n\t\t\t\t]\n\t\t\t};\n    \t});\n    \t\n\t}\n});\n",
  "view": "Form"
 }
]